import{__assign as e}from"../../_virtual/_tslib.js";import{jsxs as o,jsx as t}from"theme-ui/jsx-runtime";import r,{useContext as i,useMemo as n}from"react";import{get as l}from"theme-ui";import{useSelect as s,SELECT_BULK_ACTIONS as a}from"./hooks/useSelect.js";import"../Accordion/Accordion.js";import d from"../Icon/Icon.js";import"downshift";import u from"../Button/Button.js";import p from"../Popover/Popover.js";import{isBrowser as c}from"../../helpers/ssr.js";import"../DateSelect/DateSelect.js";import"../DesktopModal/DesktopModal.js";import"../EditableField/Group/EditableFieldGroup.js";import{InputGroupContext as m}from"../InputGroup/Context.js";import"../EditableField/Select/EditableFieldSelect.js";import"../LinearProgress/LinearProgress.js";import"../MobileModal/MobileModal.js";import"../Radio/Radio.js";import"../SubNavigationMenu/SubNavigationMenu.js";import"react-table";import"../TableFilters/TableFilters.js";import"../Tabs/Tabs.js";import"react/jsx-runtime";import"../../theme/theme.js";import"react-dropzone";import"../ValuesList/ValuesList.js";import{getDataFromChildren as h,isArrayEqual as g}from"./utils/index.js";import{SelectOption as f}from"./SelectOption.js";import{SelectContext as v}from"./context.js";var b=function(f){var b,x=f.id,j=f.label,S=f.value,C=f.defaultValue,I=f.disabled,y=void 0!==I&&I,L=f.multi,O=void 0!==L&&L,w=f.placeholder,M=f.selectedItems,R=void 0===M?[]:M,P=f.defaultSelectedItems,k=f.onChange,E=f.onSelectedItemsChange,T=f.highlightFilled,F=void 0===T||T,B=f.fullWidth,N=void 0!==B&&B,A=f.children,D=f.renderButtonLabel,J=f.styles,G=f.isOpen,V=f.onIsOpenChange,H=i(m),_=!!H,z=n((function(){return h(A)}),[A]),W=s({isOpen:G,onIsOpenChange:V?function(e){var o=e.isOpen;return V(o||!1)}:void 0,value:S,options:z,multi:O,selectedItems:R,onChange:k,onSelectedItemsChange:E}),K=W.isOpen,X=W.selectedItem,Y=W.getToggleButtonProps,q=W.getLabelProps,Q=W.getMenuProps,U=W.highlightedIndex,Z=W.getItemProps,$=W.getDropdownProps,ee=W.handleBulkAction,oe=W.selectItem,te=W.closeMenu,re=W.openMenu,ie=n((function(){return X||0===X}),[X]),ne={resting:{backgroundColor:"text.alpha.95",color:"text.40",boxShadow:"unset",borderColor:"transparent"},hover:{backgroundColor:"text.alpha.90",color:"text",boxShadow:"unset",borderColor:"transparent"},active:{backgroundColor:"#fff",color:"text",boxShadow:function(e){return"0px 0px 0px 4px ".concat(l(e,"colors.secondary.alpha.95"))},borderColor:"secondary",fontWeight:"semibold"},filled:e({backgroundColor:"secondary.alpha.90",color:"text",boxShadow:"unset"},F?{borderColor:"secondary",fontWeight:"semibold"}:{}),filledHover:{backgroundColor:"secondary.alpha.85"}},le=n((function(){return ie&&z.find((function(e){var o=e.value;return JSON.stringify(X)===JSON.stringify(o)}))||void 0}),[ie,z,X]),se=n((function(){return P&&g(P,R)}),[P,R]),ae=(C||0===C)&&JSON.stringify(C)===JSON.stringify(X),de=!se&&!ae&&(ie||R.length>0),ue=n((function(){return y?{}:K?ne.active:de?ne.filledHover:ne.hover}),[y,K,de,ne.active,ne.filledHover,ne.hover]);return o("div",{sx:e(e({display:"flex",alignItems:"center",position:"relative",opacity:y?.3:1,variant:"text.body1"},_&&e({},!(null==H?void 0:H.isLast)&&{borderRight:"1px solid",borderColor:"text.90",flexGrow:0})),null==J?void 0:J.root),children:[j&&t("label",e({sx:e({marginRight:2,fontSize:14,color:"text.40"},y?{}:{cursor:"pointer"})},q({disabled:y,htmlFor:x}),{children:j})),t(p,{alwaysRenderContent:!0,isVisible:K,appendTo:c?null===document||void 0===document?void 0:document.body:void 0,trigger:["manual"],isInteractive:!0,placement:"bottom-start",noPadding:!0,content:o("div",e({},Q({disabled:y},{suppressRefError:!0}),{onBlur:null,sx:e({maxHeight:350,overflowY:"auto",padding:4,outline:0,margin:0,marginTop:1},null==J?void 0:J.popoverContent),children:[r.Children.map(A,(function(e,o){return r.isValidElement(e)?t(v.Provider,{value:{index:o,highlightedIndex:U,selectItem:oe,selectedItem:X,selectedItems:R,multi:O,getItemProps:Z,closeMenu:te,openMenu:re},children:e}):null})),O&&t(u,{variant:"plain",color:"secondary",sx:{cursor:"pointer",width:"100%",justifyContent:"start"},onClick:function(){if(R.length>0)return ee(a.DESELECT_ALL),!0;ee(a.SELECT_ALL)},children:R.length>0?"Limpar seleções":"Selecionar todos"})]})),children:o("button",e({sx:e(e(e(e(e(e(e({display:"flex",gap:2,borderRadius:2,height:[40,36],paddingX:3,justifyContent:"space-between",alignItems:"center",outline:0,border:"2px solid transparent",transition:"all .2s linear"},_&&e(e({},!(null==H?void 0:H.isFirst)&&{borderTopLeftRadius:0,borderBottomLeftRadius:0}),!(null==H?void 0:H.isLast)&&{borderTopRightRadius:0,borderBottomRightRadius:0})),N?{flexGrow:1}:{}),de?ne.filled:ne.resting),!y&&{cursor:"pointer"}),{"&:hover":ue,"&:focus":ne.active}),K&&ne.active),null==J?void 0:J.button),tabIndex:"0",type:"button"},Y(e(e({id:x,"aria-labelledby":""},$({preventKeyAction:K})),{disabled:y})),{children:[t("span",{children:null!==(b=null==D?void 0:D({selectedItems:R,selectedOption:le,value:S}))&&void 0!==b?b:O?function(){var e;return R.length>0?R.length===z.length?"All":1===R.length?null===(e=z.find((function(e){var o=e.value;return JSON.stringify(R[0])===JSON.stringify(o)})))||void 0===e?void 0:e.label:R.length+" selected":w||"Select one or more options"}():ie&&(null==le?void 0:le.label)||void 0!==w&&w||"Select an option"}),t(d,{name:"IconChevronDown",size:12,stroke:3})]}))})]})};b.Option=f;export{b as default};
//# sourceMappingURL=Select.js.map
